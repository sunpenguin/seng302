<!DOCTYPE html>
<html>
    <head>
        <style>
            html, body {
                height: 100%;
                margin: 0;
                padding: 0;
            }
            #map {
                height: 100%;
            }
            #floating-panel {
                position: absolute;
                top: 40px;
                left: 10px;
                z-index: 5;
                background-color: #fff;
                padding: 5px;
                border: 1px solid #999;
                text-align: left;
                font-family: 'Roboto','sans-serif';
                line-height: 20px;
                padding-left: 10px;
                font-family: Roboto, Arial, sans-serif;
                font-size: 11px;
            }
        </style>
        <!--<script src="http://maps.google.com/maps/api/js?sensor=false"></script>-->
    </head>
    <body>
        <div id="map"></div>
        <script
                src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
                integrity="sha256-k2WSCIexGzOj3Euiig+TlR8gA0EmPjuc79OEeY5L45g="
                crossorigin="anonymous"></script>
        <script async defer
                src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAEPZMfQYbi9GPoO_Jy6Q1W9aocnTQiUYc&callback=initMap">
        </script>
        <script>
                var map;
                var centerCoordinate = {lat: 0, lng: 0};
                var markers = [];
                var s;
                var w;
                var n;
                var e;
                var zoomed = false;
                var bounds = new google.maps.LatLngBounds();

                function initMap() {
                    var options = {
                        zoom: 1,
                        center: centerCoordinate,
                        mapTypeId: 'terrain',
                        mapTypeControl: false,
                        draggable: false,
                        scaleControl: false,
                        scrollwheel: false,
                        navigationControl: false,
                        streetViewControl: false,
                        keyboardShortcuts: false,
                        disableDefaultUI: true
                    };
                    map = new google.maps.Map(document.getElementById('map'),
                        options);

                    google.maps.event.addListener(map, 'bounds_changed', function() {
                        bounds = new google.maps.LatLngBounds();
                        for (var i = 0; i < markers.length; i++) {
                            bounds.extend(markers[i].getPosition());
                        }

                        if (!zoomed) {
                             map.fitBounds(bounds);
                        }

//                        if (zoomed) {
//                            map.setZoom(20);
//                        }

                        s = map.getBounds().getSouthWest().lat();
                        w = map.getBounds().getSouthWest().lng();
                        n = map.getBounds().getNorthEast().lat();
                        e = map.getBounds().getNorthEast().lng();
                    });
                }

                function resetMarkers() {
                    markers = [];
//                    bounds = new google.maps.LatLngBounds();
                }

                function addMarker (lat, lng) {
                    marker = new google.maps.Marker({
                        position: {lat: lat, lng: lng},
                        map: map,
                        visible: false
                    });
                    markers.push(marker);
                }

                function getS() {
                    return s;
                }

                function getW() {
                    return w;
                }

                function getN() {
                    return n;
                }

                function getE() {
                    return e;
                }

                function setCenter(lat, lng) {
                    map.setCenter({lat: lat, lng:lng});
                    return 0;
                }

                function convertCoordX(lat, lng) {
                    var coord = new google.maps.LatLng(lat, lng);
                    var projection = map.getProjection();
                    var point = projection.fromLatLngToPoint(coord);
                    return point.x;
                }

                function convertCoordY(lat, lng) {
                    var coord = new google.maps.LatLng(lat, lng);
                    var projection = map.getProjection();
                    var point = projection.fromLatLngToPoint(coord);
                    return point.y;
                }

                function toggleZoomed() {
                    zoomed = !zoomed;
                }
        </script>
    </body>
</html>
